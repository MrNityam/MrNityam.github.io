<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://www.google.com/recaptcha/api.js"></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">
  <title>Mr Nityam - Contact Page</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
       <!--contact form starts----------------------------------->
        <div class="contact-form ">
            <div class="contact-form-inner">
              <div class="contact-form-container">

                <form method="post" autocomplete="on" name="google-sheet">
                                                
                  <div class="row">
                    <div class="input-group">
                      <input type="text" name="name" placeholder="Your Name" class="input-control" required>
                    </div>
                    <div class="input-group">
                      <input type="email" name="email" placeholder="Your Email" class="input-control" required>
                    </div>
                    <div class="input-group">
                      <input type="text" name="subject" placeholder="Subject" class="input-control" required>
                    </div>
                    <div class="input-group">
                      <input type="datetime-local" name="date" placeholder="Date And Time" class="input-control" required>
                    </div>
                    <div class="input-group">
                     <textarea name="message" placeholder="Message" class="input-control"></textarea>
                    </div>
                    <div class="g-recaptcha" data-sitekey="6Le0w8YaAAAAAF63YnIG4WSVj9PvvDHurW8sDyvR"></div>
                    <div class="input-group">
                      <button type="submit" class="btn btn-submit">Send</button>
                     </div>
                  </div>
                </form>
              </div>
            </div>
          </div>    
          <?php
          if(isset($_POST['sendEmail'])) {
            $privateKey = "6Le0w8YaAAAAAIbOXnywo_COXMl11TL7S7oa3rBi";
            $response = $_POST['g-recaptcha-response'];
            $remoteip = $_SERVER['REMOTE_ADDR'];
            $url = file_get_contents("https://www.google.com/recaptcha/api/siteverify?secret=$privateKey&response=$response&remoteip=$remoteip");
        
            $result = json_decode($url, true);
        
            if($result->success == true) {
              $name = strip_tags(trim($_POST['name_1']));
              $email = strip_tags(trim($_POST['email_1']));
              $subject = strip_tags(trim($_POST['subject_1']));
              $date = strip_tags(trim($_POST['date_1']));
              $Message = strip_tags(trim($_POST['Message_1']));
              $userArray = [
                'name' => $name,
                'email' => $email,
                'subject' => $subject,
                'date' => $date,
                'Message' => $Message,
              ];
              var_dump($userArray);
        
            } else {
              echo "reCaptcha failed, please try again...";
            }
          }
        
        ?>

          <script type="text/javascript">


            const scriptURL = 'https://script.google.com/macros/s/AKfycbx6vWHA5s7uUK7Uqfp1iMD1k2A4XPsMX75VL8lpPabbWGb6mpjHDqBhIroA-bZjJbcYpQ/exec'
                    const form = document.forms['google-sheet']
                  
                    form.addEventListener('submit', e => {
                      e.preventDefault()
                      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
                        .then(response => alert("Thanks for Contacting Techie Nityam. You will get reply ASAP on the Email you provided."))
                        .catch(error => console.error('Sorry! somethong went wrong. Please try again later.', error.message))
                    })
          </script>
        
        
        
<!--contact form ends-------------------------------------->
</body>
</html>